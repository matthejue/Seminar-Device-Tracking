%!Tex Root = ../main.tex

\begin{algorithm}{\pr{Finding Attacker 3-Tuple per Cell (Phase 1)}}{\thetcbcounter}\label{alg:phase1}
	\begin{pseudo}[indent-mark,kw,hl-warn=false]
    procedure \cn{SendBurst}\tn{(}\tt{X}\tn{)}\\+
    for all \tt{x} $\in$ \tt{X} do\\+
\cn{AttemptConnectTCP}\tn{(}\tt{x}\tn{)}\\--
procedure \cn{GetSourcePorts}\tn{(}\tt{U}\tn{)}\\+
\cn{SendBurst}\tn{(}\tt{U}\tn{)}\\
\tt{R} $\leftarrow$ \cn{ReceiveAttackerTupleToPortMap}\tn{()}\\
return \tt{R}\\-
procedure \cn{Phase1}\\+
\tt{S'} $\leftarrow\emptyset$\\
while $|\tt{S'}| < \tt{T}$ do\\+
$\tt{S}$ $\leftarrow$ \cn{GetNewExternalDestinations}\tn{()}\\
\tt{C} $\leftarrow$ \cn{GetSourcePorts}\tn{(}$\tt{S}$\tn{)} \cmt{// 1st burst}\\
\cn{SendBurst}\tn{(}\tt{S'}\tn{)} \cmt{// 2nd burst}\\
\tt{C'} $\leftarrow$ \cn{GetSourcePorts}\tn{(}$\tt{S}$\tn{)} \cmt{// 3rd burst}\\
\tt{S'} $\leftarrow \tt{S'} \cup \{x\,|\,\tt{C'}(x)-\tt{C}(x)=1\}$\\-
return \tt{S'}
	\end{pseudo}
\end{algorithm}
